# Vite Press æ­å»ºæ•™ç¨‹

> [!TIP]
>
> ä½¿ç”¨ [VitePress](https://vitepress.dev/guide/getting-started) æ­å»ºä¸ªäººåšå®¢ï¼Œä¸»è¦ç”¨äºè®°å½•æ­å»ºè¿‡ç¨‹

## ä¸€ã€æ¦‚è¿°

### 1.1 VitePress ä»‹ç»

[VitePress](https://vitepress.dev/zh/) æ˜¯ä¸€ä¸ªåŸºäº Vite å’Œ Vue 3 çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œä¸“é—¨ä¸ºæ„å»ºæ–‡æ¡£ç½‘ç«™è€Œè®¾è®¡ã€‚å®ƒæ˜¯ VuePress çš„ç»§æ‰¿è€…ï¼Œæ—¨åœ¨æä¾›æ›´å¿«çš„æ„å»ºé€Ÿåº¦å’Œæ›´ç°ä»£çš„å¼€å‘ä½“éªŒã€‚VitePress åˆ©ç”¨äº† Vite çš„å³æ—¶æœåŠ¡å™¨å¯åŠ¨å’Œæ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰åŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘æ–‡æ¡£ç½‘ç«™å˜å¾—æ›´åŠ é«˜æ•ˆã€‚

ä»¥ä¸‹æ˜¯ VitePress çš„ä¸€äº›å…³é”®ç‰¹æ€§ï¼š

1. **å¿«é€Ÿå¼€å‘æœåŠ¡å™¨**ï¼šVitePress ä½¿ç”¨ Vite ä½œä¸ºå…¶å¼€å‘æœåŠ¡å™¨ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥äº«å—åˆ°å‡ ä¹å³æ—¶çš„æœåŠ¡å™¨å¯åŠ¨å’Œå¿«é€Ÿçš„ HMR

2. **åŸºäº Vue 3**ï¼šVitePress å®Œå…¨åŸºäº Vue 3ï¼ŒåŒ…æ‹¬ Composition APIã€Teleportã€Suspense ç­‰æ–°ç‰¹æ€§

3. **Markdown æ‰©å±•**ï¼šVitePress å¯¹ Markdown è¯­æ³•è¿›è¡Œäº†æ‰©å±•ï¼Œæ”¯æŒ Vue ç»„ä»¶ã€ä»£ç é«˜äº®ã€ç›®å½•ã€è‡ªå®šä¹‰å®¹å™¨ç­‰åŠŸèƒ½

4. **ä¸»é¢˜å®šåˆ¶**ï¼šä½ å¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜æ¥å®šåˆ¶ç½‘ç«™çš„å¤–è§‚å’Œæ„Ÿè§‰ï¼ŒVitePress çš„ä¸»é¢˜ç³»ç»Ÿå…è®¸ä½ å®Œå…¨æ§åˆ¶ç½‘ç«™çš„æ ·å¼å’Œå¸ƒå±€

5. **é™æ€ç«™ç‚¹ç”Ÿæˆ**ï¼šVitePress ç”Ÿæˆçš„æ˜¯é™æ€ HTML æ–‡ä»¶ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å°†å®ƒä»¬éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ä¸Šï¼Œå¦‚ GitHub Pagesã€Netlifyã€Vercel ç­‰

6. **æ’ä»¶ç³»ç»Ÿ**ï¼šVitePress æ”¯æŒæ’ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡æ’ä»¶æ¥æ‰©å±• VitePress çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ æ–°çš„ Markdown æ‰©å±•ã€ä¿®æ”¹æ„å»ºè¿‡ç¨‹ç­‰ã€‚

7. **å›½é™…åŒ–æ”¯æŒ**ï¼šVitePress å†…ç½®äº†å¯¹å¤šè¯­è¨€æ–‡æ¡£çš„æ”¯æŒï¼Œå¯ä»¥è½»æ¾åœ°ä¸ºä¸åŒè¯­è¨€çš„è¯»è€…æä¾›ç¿»è¯‘

8. **SEO å‹å¥½**ï¼šç”±äº VitePress ç”Ÿæˆçš„æ˜¯é™æ€å†…å®¹ï¼Œå› æ­¤å®ƒå¯¹æœç´¢å¼•æ“ä¼˜åŒ–ï¼ˆSEOï¼‰éå¸¸å‹å¥½

![image-20240516174320355](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516174320355.png)

### 1.2 åŠŸèƒ½

- markdown æ‹“å±•æ”¯æŒ
- å¼•å…¥ giscus å®ç°è¯„è®ºåŠŸèƒ½
- PicGO + OSS å®ç°å›¾ç‰‡ä¸Šä¼ 
- é€šè¿‡ github workflow è‡ªè¡Œæ­å»ºéƒ¨ç½²
- æä¾› Docker Image å®¹å™¨åŒ–éƒ¨ç½²
- é€šè¿‡ electron æ‰“åŒ…åˆ†å‘

## äºŒã€ç¯å¢ƒå®‰è£…

### 2.1 node + yarn

> [!CAUTION]
>
> - æ¡ˆä¾‹ä½¿ç”¨æœ€æ–°çš„ [node](https://nodejs.org/en/download) ç‰ˆæœ¬ `20.13.0` å…¶å®ƒç‰ˆæœ¬è¯·è‡ªè¡Œæµ‹è¯• (vite press å®˜æ–¹è¦æ±‚ node ç‰ˆæœ¬éœ€è¦ 18+)

node çš„å®‰è£…æ¨èä½¿ç”¨ nvm è¿›è¡Œå®‰è£…ï¼Œnvm æ˜¯ä¸€æ¬¾ node çš„ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ node ï¼Œå®‰è£…æ–¹å¼ï¼š

- ç›´æ¥åˆ° https://github.com/coreybutler/nvm-windows/releases/tag/1.1.12 è¿›è¡Œä¸‹è½½å³å¯

![image-20240516180515773](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516180515773.png)

å®‰è£…å¥½åå¯ä»¥é€šè¿‡ `nvm -v` æŸ¥çœ‹ nvm çš„ç‰ˆæœ¬

å…·ä½“ä½¿ç”¨è¯·å‚è€ƒ https://github.com/coreybutler/nvm-windows

æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆé€šè¿‡ nvm å®‰è£… node + npmï¼Œç„¶åé€šè¿‡ npm å®‰è£… yarn

- æ‰§è¡Œ `nvm install 20.13.0`
- å®‰è£…å®Œæ¯•åæ‰§è¡Œ `nvm use 20.13.0`
- å®‰è£… yarn `npm install --global yarn`
- è¾“å‡ºä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹

![image-20240516130103516](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516130103516.png)

### 2.2 git

[Git](https://git-scm.com/) æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå®ƒè¢«å¹¿æ³›ç”¨äºè·Ÿè¸ªå’Œç®¡ç†è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­çš„ä»£ç å˜æ›´ã€‚Git ç”± Linus Torvalds åœ¨2005å¹´åˆ›å»ºï¼Œæœ€åˆæ˜¯ä¸ºäº†ç®¡ç† Linux å†…æ ¸çš„å¼€å‘ï¼Œä½†ç°åœ¨å®ƒå·²ç»æˆä¸ºå…¨çƒå¼€å‘è€…ç¤¾åŒºä¸­æœ€å—æ¬¢è¿çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ä¹‹ä¸€ã€‚

![image-20240516175400308](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516175400308.png)

> [!TIP]
>
> å®‰è£…å¥½ git åæœ€åè¿›è¡Œä¸‹ä»£ç†é…ç½® ï¼ˆé…ç½®æ–‡ä»¶è·¯å¾„ä¸º ç”¨æˆ·ç›®å½•/.gitconfigï¼‰å¦‚æœç”¨æˆ·ç›®å½•ä¸‹æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œç›´æ¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªå°±å¯ä»¥

![image-20240516175626830](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516175626830.png)

å°†ä¸‹é¢çš„å†…å®¹æ·»åŠ åˆ° `.gitconfig` ä¸­

```ini
[user]
  name = cbq-win
  email = 2024cbq@gmail.com
[http]
  proxy = http://127.0.0.1:7890
  postBuffer = 5M
[https]
  proxy = https://127.0.0.1:7890
```

æŸ¥çœ‹ `git config --list`

![image-20240516175750338](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516175750338.png)

### 2.3 WebStorm

[WebStorm ](https://www.jetbrains.com/webstorm/promo/?msclkid=c817a54659e31aee6ed4c30381237bf5&utm_source=bing&utm_medium=cpc&utm_campaign=APAC_en_JP_WebStorm_Branded&utm_term=webstorm&utm_content=webstorm)æ˜¯ä¸€æ¬¾ç”± JetBrains å…¬å¸å¼€å‘çš„é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œä¸“ä¸º JavaScriptã€TypeScriptã€HTML å’Œ CSS ç­‰å‰ç«¯æŠ€æœ¯æ ˆçš„å¼€å‘è€Œè®¾è®¡ã€‚å®ƒæä¾›äº†å¼ºå¤§çš„ä»£ç ç¼–è¾‘ã€è°ƒè¯•ã€ç‰ˆæœ¬æ§åˆ¶å’Œè‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ—¨åœ¨æé«˜å¼€å‘è€…çš„å·¥ä½œæ•ˆç‡å’Œä»£ç è´¨é‡ã€‚

![image-20240516175914413](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516175914413.png)

> [!TIP]
>
> æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º 2024.1.2ï¼Œæ¨èå¯¹ WebStorm ä¹Ÿè¿›è¡Œä¸‹ä»£ç†é…ç½®

![image-20240516180127273](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516180127273.png)

![image-20240516180141126](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516180141126.png)

## ä¸‰ã€ä½¿ç”¨

### 3.1 åˆå§‹åŒ– VitePress

1. `yarn add -D vitepress`

![image-20240516130828804](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516130828804.png)

2. `yarn vitepress init`

![image-20240516131011334](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516131011334.png)

3. `yarn run docs:dev`

![image-20240516131146093](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516131146093.png)

> [!TIP]
>
> ç‚¹å‡» `localhost:5173` å‡ºç°ä¸‹é¢é¡µé¢å³ä¸ºæ­å»ºæˆåŠŸ

![image-20240516131201607](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240516131201607.png)

## å››ã€é¡¹ç›®è¯´æ˜

>  [!IMPORTANT]
>
> - `.github æ–‡ä»¶å¤¹` (éœ€ä½äºé¡¹ç›®æ ¹ç›®å½•ä¸‹å…¶ä¸‹é¢çš„ *.yaml æ–‡ä»¶éƒ½ä¼šè¢« github è‡ªåŠ¨è¯†åˆ«ç”¨äºè‡ªåŠ¨æ„å»º)
> - `config æ–‡ä»¶å¤¹` nginx é…ç½®æ–‡ä»¶æ­é… Dockerfile ç”¨äºé•œåƒæ„å»º
> - `docs æ–‡ä»¶å¤¹` VitePress å·¥ä½œæ–‡ä»¶å¤¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå°†è¯¥æ–‡ä»¶ä¸‹çš„ *.md æ¸²æŸ“ä¸º html å‘ˆç°
>   - `.vitepress`  ç”¨äºå­˜æ”¾ä¸»é¢˜é…ç½®å’Œæ’ä»¶é…ç½®ç­‰
>   - `dev-tools` è‡ªå®šä¹‰æ–‡ä»¶å¤¹ï¼Œä¸»è¦ç”¨äºå­˜æ”¾å¼€å‘å·¥å…·ç›¸å…³ç¬”è®°
>   - `example` è‡ªå®šä¹‰æ–‡ä»¶å¤¹ï¼Œä¸»è¦ç”¨äºå­˜æ”¾æ¡ˆä¾‹ç›¸å…³ç¬”è®°
>   - `public` ä¸»è¦ç”¨äºå­˜æ”¾å…¬å…±èµ„æº
>   - `ABOUT.md` è‡ªå®šä¹‰æ–‡ä»¶ï¼Œå¯¹åº” å…³äºæˆ‘ é¡µé¢ https://caobaoqi1029.github.io/docs-template/ABOUT.html
>   - `CHANGELOG.md` è‡ªå®šä¹‰æ–‡ä»¶ï¼Œå¯¹åº” ç‰ˆæœ¬ é¡µé¢ https://caobaoqi1029.github.io/docs-template/CHANGELOG.html
>   - `index.md` æ–‡æ¡£å…¥å£æ–‡ä»¶ï¼Œå¯¹åº” https://caobaoqi1029.github.io/docs-template/
> - `package.json` ç”¨äºå®šä¹‰é¡¹ç›®ä¾èµ–åŠ script å‘½ä»¤

![image-20240602154451113](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602154451113.png)

> [!CAUTION]
>
> é»˜è®¤æƒ…å†µä¸‹ VitePress ä¼šå°†æ¯ä¸ªç›®å½•ä¸‹çš„ index.md æ–‡ä»¶è§£æä¸ºè¯¥ç›®å½•ä¸‹çš„å…¥å£æ–‡ä»¶ï¼Œå› æ­¤å»ºè®®å‘½åçš„æ—¶å€™ç›´æ¥æŒ‡æ˜

![image-20240602162014057](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602162014057.png)

> æ›´å¤šä¿¡æ¯å¯å‚è§
>
> - https://vitepress.dev/zh/guide/getting-started
> - https://vitepress.dev/zh/reference/site-config#vite%E3%80%81vue-%E5%92%8C-markdown-%E9%85%8D%E7%BD%AE

![image-20240602162033023](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602162033023.png)

## äº”ã€éƒ¨ç½²

> [!TIP]
>
> tag æ“ä½œå¯å‚è§ [é¡¹ç›®è¯´æ˜](# å››ã€é¡¹ç›®è¯´æ˜)

### 5.1 éƒ¨ç½²åˆ° github pages

> [!NOTE]
>
> é¡¹ç›®é€šè¿‡ github workflow å·¥ä½œæµè‡ªåŠ¨éƒ¨ç½²ï¼Œå…¶ä¸­ GitHub Workflow æ˜¯ GitHub æä¾›çš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œä½¿ç”¨ GitHub Actions å®ç°ã€‚å®ƒä½¿å¼€å‘è€…å¯ä»¥åœ¨ä»£ç åº“ä¸­è‡ªåŠ¨åŒ–å„ç§ä»»åŠ¡ï¼Œä»ä»£ç çš„æ„å»ºã€æµ‹è¯•åˆ°éƒ¨ç½²ã€‚

1. ä¸ºé¡¹ç›®åˆ›å»ºç›¸å…³ä»“åº“ ([ç”¨æˆ·å].github.io) è¦æ±‚è¯¥ä»“åº“ä¸ºå…¬å¼€åº“

![image-20240602154853439](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602154853439.png)

2. åˆ›å»º workflow æ–‡ä»¶ ï¼ˆå³é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ github/*.yaml æ–‡ä»¶éƒ½ä¼šè¢« github è‡ªåŠ¨è¯†åˆ«ï¼‰ä¸‹é¢ä¸ºè¯¥é¡¹ç›®çš„ï¼švite-press-deploy.yaml æ–‡ä»¶

```yaml
name: CI|CD éƒ¨ç½²æ–‡æ¡£
permissions:
  contents: write
on:
  push:
    tags:
      - v*

jobs:
  build:
    name: build vite press
    runs-on: ${{ matrix.os }}
    defaults:
      run:
        shell: bash

    if: startsWith(github.ref, 'refs/tags/')
    strategy:
      fail-fast: false
      matrix:
        os: [ ubuntu-latest ]

    steps:
      - name: è¯»å–ä»“åº“å†…å®¹ ğŸ‘“
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: è®¾ç½® Node.js ğŸ¶
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: å®‰è£… yarn ğŸ¸
        run: npm install --global yarn

      - name: æ„å»ºæ–‡æ¡£ ğŸ”¨
        env:
          NODE_OPTIONS: --max_old_space_size=8192
        run: |-
          yarn install
          yarn run docs:build
          > docs/.vitepress/dist/.nojekyll

      - name: éƒ¨ç½²æ–‡æ¡£ ğŸ‘Œ
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: pages
          folder: docs/.vitepress/dist

```

> [!NOTE]
>
> 1. **è§¦å‘å™¨**ï¼šå½“æ¨é€ä»¥ `v` å¼€å¤´çš„æ ‡ç­¾æ—¶è§¦å‘å·¥ä½œæµã€‚
> 2. **è¿è¡Œç¯å¢ƒ**ï¼šä½¿ç”¨ Ubuntu æœ€æ–°ç‰ˆæœ¬ä½œä¸ºè¿è¡Œç¯å¢ƒã€‚
> 3. æ­¥éª¤ï¼š
>    - æ£€å‡ºä»“åº“å†…å®¹ã€‚
>    - è®¾ç½® Node.js ç‰ˆæœ¬ä¸º 20ã€å®‰è£… yarnã€‚
>    - æ„å»º VitePress æ–‡æ¡£ï¼Œå¹¶ç”Ÿæˆ `.nojekyll` æ–‡ä»¶ã€‚
>    - å°†æ„å»ºçš„æ–‡æ¡£éƒ¨ç½²åˆ° GitHub Pages çš„ `pages` åˆ†æ”¯ã€‚
>
> é€šè¿‡è¿™ä¸ªå·¥ä½œæµï¼Œå®ç°äº†ä»æ„å»ºåˆ°éƒ¨ç½²çš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œç¡®ä¿æ–‡æ¡£åœ¨æ¯æ¬¡å‘å¸ƒæ–°ç‰ˆæœ¬æ ‡ç­¾æ—¶éƒ½èƒ½åŠæ—¶æ›´æ–°å’Œå‘å¸ƒã€‚

![image-20240602160932985](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602160932985.png)

![image-20240516182545151](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/202405161825256.png)

3. å®Œæˆä¸Šé¢æ“ä½œåä¼šæœ‰ pages åˆ†æ”¯

![image-20240602155442367](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602155442367.png)

4. éƒ¨ç½²åˆ° github pages

![image-20240602155554605](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602155554605.png)

![image-20240602155622819](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602155622819.png)

![image-20240602155639384](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602155639384.png)

### 5.2 å‘å¸ƒä¸º Release

> [!CAUTION]
>
> æ³¨æ„ï¼šå‘å¸ƒä¸º Release å’Œ Docker Image å¯¹äºæ–‡æ¡£ç±»å¹¶æ²¡å¤šå¤§çš„ç”¨å¤„ï¼ˆé€šè¿‡ä¸Šè¿°çš„ github pages å·²ç»å¯ä»¥æ»¡è¶³æ–‡æ¡£ç±»é¡¹ç›®çš„éƒ¨ç½²äº†ï¼‰ æ­¤å¤„å†™å‡ºæ¥åªæ˜¯ä¸ºäº†å•çº¯è®°å½•

è¦æƒ³å‘å¸ƒä¸º Release ä»…éœ€åœ¨ä¸Šé¢çš„ yaml æ–‡ä»¶çš„ ï¼ˆæ„å»ºæ–‡æ¡£ ğŸ”¨ å’Œ  éƒ¨ç½²æ–‡æ¡£ ğŸ‘Œï¼‰ ä¹‹é—´åŠ å…¥ç›¸å…³æ­¥éª¤ (æ‰“åŒ… zip æ–‡ä»¶ ğŸ”¨ã€upload artifacts ğŸ“¦ã€release ğŸ˜¶â€ğŸŒ«ï¸) å³å¯

```yaml
      - name: æ„å»ºæ–‡æ¡£ ğŸ”¨
        env:
          NODE_OPTIONS: --max_old_space_size=8192
        run: |-
          yarn install
          yarn run docs:build
          > docs/.vitepress/dist/.nojekyll

      - name: æ‰“åŒ… zip æ–‡ä»¶ ğŸ”¨ // [!code ++]
        run: |
          mkdir -p ./build
          zip -r ./pages.zip ./docs/.vitepress/dist
          echo "pages.zip æ‰“åŒ…æˆåŠŸ"
          cp ./pages.zip ./build/

      - name: upload artifacts ğŸ“¦ // [!code ++]
        uses: actions/upload-artifact@v4
        with:
          name: ${{ matrix.os }}
          path: build

      - name: release ğŸ˜¶â€ğŸŒ«ï¸ // [!code ++]
        uses: softprops/action-gh-release@v1
        if: startsWith(github.ref, 'refs/tags/')
        with:
          files: 'build/**'
        env:
          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }}

      - name: éƒ¨ç½²æ–‡æ¡£ ğŸ‘Œ
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: pages
          folder: docs/.vitepress/dist
```

![image-20240602160612380](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602160612380.png)

### 5.3 å‘å¸ƒä¸º Docker Image

> [!CAUTION]
>
> æ­¤å¤„æ¼”ç¤ºçš„æ˜¯å°†é¡¹ç›®å‘å¸ƒåˆ° github çš„ Docker Registory å³ (ghcr.io)

ä¸‹é¢ä¸ºè¯¥é¡¹ç›®çš„ï¼špush-docker.yaml æ–‡ä»¶

```yaml
#
name: CI|CD Docker æ¨é€

# This workflow runs when any of the following occur:
# - A push is made to a branch called `main` or `seed`
# - A tag starting with "v" is created
# - A pull request is created or updated
on:
  push:
    tags:
      - v*
  pull_request:
  # This creates an environment variable called `IMAGE_NAME ` with the value `ghtoken_product_demo`.
env:
  IMAGE_NAME: docs-template
#
jobs:
  # This pushes the image to GitHub Packages.
  push:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    permissions:
      packages: write
      contents: read
      #
    steps:
      - name: è¯»å–ä»“åº“å†…å®¹ ğŸ‘“
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: è®¾ç½® Node.js ğŸ¶
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: å®‰è£… yarn ğŸ¸
        run: npm install --global yarn

      - name: æ„å»ºæ–‡æ¡£ ğŸ”¨
        env:
          NODE_OPTIONS: --max_old_space_size=8192
        run: |-
          yarn install
          yarn run docs:build
          > docs/.vitepress/dist/.nojekyll

      - name: Build image
        run: docker build . --file Dockerfile --tag $IMAGE_NAME --label "runnumber=${GITHUB_RUN_ID}"

      - name: Log in to registry
        run: echo "${{ secrets.GITHUB_TOKEN }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin

      - name: Push image
        run: |
          IMAGE_ID=ghcr.io/${{ github.repository_owner }}/$IMAGE_NAME

          # This changes all uppercase characters to lowercase.
          IMAGE_ID=$(echo $IMAGE_ID | tr '[A-Z]' '[a-z]')
          # This strips the git ref prefix from the version.
          VERSION=$(echo "${{ github.ref }}" | sed -e 's,.*/\(.*\),\1,')
          # This strips the "v" prefix from the tag name.
          [[ "${{ github.ref }}" == "refs/tags/"* ]] && VERSION=$(echo $VERSION | sed -e 's/^v//')
          # This uses the Docker `latest` tag convention.
          [ "$VERSION" == "main" ] && VERSION=latest
          echo IMAGE_ID=$IMAGE_ID
          echo VERSION=$VERSION
          docker tag $IMAGE_NAME $IMAGE_ID:$VERSION
          docker push $IMAGE_ID:$VERSION

```

![image-20240602160905211](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602160905211.png)

![image-20240602160653226](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602160653226.png)

## å…¶å®ƒ

> [!TIP]
>
> ä¸‹é¢çš„å†…å®¹ä¸»è¦ä¸ºæ’ä»¶é…ç½®ï¼Œé€šè¿‡æ’ä»¶æˆ‘ä»¬å¯ä»¥æ‹“å±• VitePress åŠŸèƒ½ï¼Œå®ç°æ›´å¼ºçš„è‡ªå®šä¹‰ï¼Œå¯¹äºæ’ä»¶é…ç½®æ¥è¯´ï¼Œé€šå¸¸æ­¥éª¤ä¸ºï¼š
>
> 1. åœ¨ package.json ä¸­æ·»åŠ ç›¸å…³æ’ä»¶çš„åæ ‡ï¼Œå¼•å…¥ä¾èµ–
> 2. åœ¨ .vitepress/theme/index.js ä¸­é…ç½®æ’ä»¶

### X.1 ä¸ºé¡¹ç›®æ·»åŠ å…¬å¼æ”¯æŒ

```json
"markdown-it": "^14.1.0",
"markdown-it-mathjax3": "^4.3.2",
```

åœ¨ .vitepress/config.mjs ä¸­æ·»åŠ 

```js
    markdown: {
        math: true,
        lineNumbers: true
    },
```

![image-20240602163942376](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602163942376.png)

### X.2 æ·»åŠ æˆå‘˜ç»„ä»¶

å¯ä»¥åœ¨ä»»ä½•é¡µé¢ä¸Šä½¿ç”¨ä» `vitepress/theme` æš´éœ²å‡ºçš„å…¬å…±ç»„ä»¶ `<VPTeamMembers>` æ˜¾ç¤ºå›¢é˜Ÿæˆå‘˜ã€‚

```md
<script setup>
import { VPTeamMembers } from 'vitepress/theme';

const members = [
  {
    avatar: 'https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/avatar.png',
    name: 'cbq1029',
    title: 'Creator',
    links: [
      { icon: 'github', link: 'https://github.com/caobaoqi1029' },
      { icon: {
                    svg: '<svg t="1713342157310" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1444" width="16" height="16"><path d="M512 960A448 448 0 1 1 512 64a448 448 0 0 1 0 896z m226.752-497.792H484.352a22.144 22.144 0 0 0-22.144 22.144v55.296c0 12.224 9.92 22.144 22.08 22.144h154.88c12.288 0 22.144 9.92 22.144 22.08v11.072c0 36.672-29.696 66.368-66.368 66.368H384.768a22.144 22.144 0 0 1-22.08-22.08V429.056c0-36.672 29.696-66.368 66.304-66.368h309.76c12.16 0 22.08-9.92 22.08-22.144v-55.296a22.144 22.144 0 0 0-22.08-22.144h-309.76a165.888 165.888 0 0 0-165.888 165.952v309.696c0 12.224 9.92 22.144 22.144 22.144h326.272a149.312 149.312 0 0 0 149.376-149.312V484.352a22.144 22.144 0 0 0-22.144-22.144z" fill="#C71D23" p-id="1445"></path></svg>',
                }, link: 'https://gitee.com/caobaoqi' },
      { icon: {
                    svg: '<svg t="1713342337553" class="icon" viewBox="0 0 1129 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2496" width="16" height="16"><path d="M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75h-738.7a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0" fill="#20B0E3" p-id="2497"></path><path d="M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0" fill="#20B0E3" p-id="2498"></path></svg>',
                }, link: 'https://space.bilibili.com/1045499440?spm_id_from=333.1007.0.0' }
    ]
  },
]
</script>


## Author

<VPTeamMembers size="small" :members="members" />
```

![image-20240602164208595](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602164208595.png)

### X.3 é€šè¿‡ giscus ä¸ºæ–‡æ¡£æ·»åŠ è¯„è®ºåŠŸèƒ½

> [!CAUTION]
>
> Giscus æ˜¯åˆ©ç”¨ [GitHub Discussions](https://docs.github.com/en/discussions) å®ç°çš„è¯„è®ºç³»ç»Ÿï¼Œè®©è®¿å®¢å€ŸåŠ© GitHub åœ¨ä½ çš„ç½‘ç«™ä¸Šç•™ä¸‹è¯„è®ºå’Œååº”ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯„è®ºç³»ç»Ÿä¸éœ€è¦é“¾æ¥çš„é¡¹ç›®ä»“åº“è¿›è¡Œç»‘å®šï¼Œå…¶ä¸­ä»“åº“éœ€è¦æ»¡è¶³ä»¥ä¸‹è¦æ±‚
>
> 1. **è¯¥ä»“åº“æ˜¯[å…¬å¼€çš„](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/setting-repository-visibility#making-a-repository-public)**ï¼Œå¦åˆ™è®¿å®¢å°†æ— æ³•æŸ¥çœ‹ discussionã€‚
> 2. **[giscus](https://github.com/apps/giscus) app å·²å®‰è£…**ï¼Œå¦åˆ™è®¿å®¢å°†æ— æ³•è¯„è®ºå’Œå›åº”ã€‚
> 3. **Discussions** åŠŸèƒ½å·² [åœ¨ä½ çš„ä»“åº“ä¸­å¯ç”¨](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/enabling-or-disabling-github-discussions-for-a-repository)ã€‚

![image-20240602170419866](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602170419866.png)

![image-20240602170025361](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602170025361.png)

![image-20240602170513423](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602170513423.png)

https://www.npmjs.com/package/vitepress-plugin-comment-with-giscus

![image-20240602165735501](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240602165735501.png)

```json
"vitepress-plugin-comment-with-giscus": "^1.1.15"
```

åœ¨ .vitepress/theme/index.js ä¸­æ·»åŠ  giscus ç›¸å…³ä¿¡æ¯

```
import DefaultTheme from 'vitepress/theme';
import giscusTalk from 'vitepress-plugin-comment-with-giscus';
import { useData, useRoute } from 'vitepress';
import { toRefs } from "vue";

export default {
    ...DefaultTheme,
    enhanceApp(ctx) {
        DefaultTheme.enhanceApp(ctx);
        // ...
    },
    setup() {
        // è·å–å‰è¨€å’Œè·¯ç”±
        const { frontmatter } = toRefs(useData());
        const route = useRoute();

        // è¯„è®ºç»„ä»¶ - https://giscus.app/
        giscusTalk({
            repo: 'ä½ çš„ä»“åº“åœ°å€',
            repoId: 'ä½ çš„ä»“åº“id',
            category: 'ä½ é€‰æ‹©çš„åˆ†ç±»', // é»˜è®¤: `General`
            categoryId: 'ä½ çš„åˆ†ç±»id',
            mapping: 'pathname', // é»˜è®¤: `pathname`
            inputPosition: 'top', // é»˜è®¤: `top`
            lang: 'zh-CN', // é»˜è®¤: `zh-CN`
            // i18n å›½é™…åŒ–è®¾ç½®ï¼ˆæ³¨æ„ï¼šè¯¥é…ç½®ä¼šè¦†ç›– lang è®¾ç½®çš„é»˜è®¤è¯­è¨€ï¼‰
            // é…ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢ä¸ºé”®å€¼å¯¹ç»„ï¼š
            // [ä½ çš„ i18n é…ç½®åç§°]: [å¯¹åº” Giscus ä¸­çš„è¯­è¨€åŒ…åç§°]
            locales: {
                'zh-Hans': 'zh-CN',
                'en-US': 'en'
            },
            homePageShowComment: false, // é¦–é¡µæ˜¯å¦æ˜¾ç¤ºè¯„è®ºåŒºï¼Œé»˜è®¤ä¸ºå¦
            lightTheme: 'light', // é»˜è®¤: `light`
            darkTheme: 'transparent_dark', // é»˜è®¤: `transparent_dark`
            // ...
        }, {
            frontmatter, route
        },
            // æ˜¯å¦å…¨éƒ¨é¡µé¢å¯åŠ¨è¯„è®ºåŒºã€‚
            // é»˜è®¤ä¸º trueï¼Œè¡¨ç¤ºå¯ç”¨ï¼Œæ­¤å‚æ•°å¯å¿½ç•¥ï¼›
            // å¦‚æœä¸º falseï¼Œè¡¨ç¤ºä¸å¯ç”¨ã€‚
            // å¯ä»¥åœ¨é¡µé¢ä½¿ç”¨ `comment: true` å‰è¨€å•ç‹¬å¯ç”¨
            true
        );
    }
};
